# Generated by Django 5.2 on 2025-05-28 12:19

import django.db.models.deletion
import user.models
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('user', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='MedicationCycle',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='수정일')),
                ('cycle_number', models.PositiveIntegerField(verbose_name='사이클 번호')),
                ('cycle_start', models.DateField(verbose_name='사이클 시작일')),
                ('cycle_end', models.DateField(blank=True, null=True, verbose_name='사이클 종료일')),
                ('prescription_date', models.DateField(verbose_name='처방일')),
                ('next_visit_date', models.DateField(blank=True, null=True, verbose_name='다음 방문 예정일')),
                ('notes', models.TextField(blank=True, verbose_name='메모')),
            ],
            options={
                'verbose_name': '복약 사이클',
                'verbose_name_plural': '복약 사이클들',
                'db_table': 'medication_cycles',
                'ordering': ['-cycle_start'],
            },
        ),
        migrations.CreateModel(
            name='MedicationDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='수정일')),
                ('dosage_interval', models.CharField(choices=[('HOURLY', '시간마다'), ('DAILY', '하루마다'), ('WEEKLY', '주마다'), ('PRN', '필요시'), ('BID', '하루 2회'), ('TID', '하루 3회'), ('QID', '하루 4회')], default='DAILY', max_length=10, verbose_name='복용 간격')),
                ('frequency_per_interval', models.PositiveIntegerField(default=1, verbose_name='간격당 복용 횟수')),
                ('quantity_per_dose', models.DecimalField(decimal_places=2, default=1.0, max_digits=5, verbose_name='회당 복용량')),
                ('total_prescribed', models.PositiveIntegerField(verbose_name='총 처방량')),
                ('remaining_quantity', models.PositiveIntegerField(verbose_name='잔여량')),
                ('unit', models.CharField(default='정', max_length=10, verbose_name='단위')),
                ('special_instructions', models.TextField(blank=True, verbose_name='특별 지시사항')),
                ('cycle', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='medication_details', to='bokyak.medicationcycle', verbose_name='복약 사이클')),
                ('medication', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='user.medication', verbose_name='의약품')),
            ],
            options={
                'verbose_name': '복약 상세',
                'verbose_name_plural': '복약 상세들',
                'db_table': 'medication_details',
            },
        ),
        migrations.CreateModel(
            name='MedicationAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='수정일')),
                ('alert_type', models.CharField(choices=[('DOSAGE', '복용 알림'), ('REFILL', '처방전 갱신 알림'), ('APPOINTMENT', '진료 예약 알림')], max_length=15, verbose_name='알림 유형')),
                ('alert_time', models.TimeField(verbose_name='알림 시간')),
                ('is_active', models.BooleanField(default=True, verbose_name='알림 활성화')),
                ('message', models.TextField(blank=True, verbose_name='알림 메시지')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alerts', to='user.user', verbose_name='사용자')),
                ('medication_detail', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alerts', to='bokyak.medicationdetail', verbose_name='복약 상세')),
            ],
            options={
                'verbose_name': '복약 알림',
                'verbose_name_plural': '복약 알림들',
                'db_table': 'medication_alerts',
            },
        ),
        migrations.CreateModel(
            name='MedicationGroup',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='수정일')),
                ('group_id', models.CharField(editable=False, max_length=8, primary_key=True, serialize=False, verbose_name='복약 그룹 코드')),
                ('group_name', models.CharField(max_length=50, verbose_name='복약 그룹명')),
                ('is_active', models.BooleanField(default=True, verbose_name='활성 상태')),
                ('medical_info', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='medication_groups', to='user.usermedicalinfo', verbose_name='의료 정보')),
            ],
            options={
                'verbose_name': '복약 그룹',
                'verbose_name_plural': '복약 그룹들',
                'db_table': 'medication_groups',
            },
            bases=(models.Model, user.models.CodeGeneratorMixin),
        ),
        migrations.AddField(
            model_name='medicationcycle',
            name='group',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cycles', to='bokyak.medicationgroup', verbose_name='복약 그룹'),
        ),
        migrations.CreateModel(
            name='MedicationRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='생성일')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='수정일')),
                ('record_type', models.CharField(choices=[('TAKEN', '복용함'), ('MISSED', '복용 누락'), ('SIDE_EFFECT', '부작용'), ('NOTE', '메모')], default='TAKEN', max_length=15, verbose_name='기록 유형')),
                ('record_date', models.DateTimeField(verbose_name='기록 일시')),
                ('quantity_taken', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='복용량')),
                ('notes', models.TextField(blank=True, verbose_name='기록 내용')),
                ('symptoms', models.TextField(blank=True, verbose_name='증상 기록')),
                ('cycle', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='records', to='bokyak.medicationcycle', verbose_name='복약 사이클')),
                ('medication_detail', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='records', to='bokyak.medicationdetail', verbose_name='복약 상세')),
            ],
            options={
                'verbose_name': '복약 기록',
                'verbose_name_plural': '복약 기록들',
                'db_table': 'medication_records',
                'ordering': ['-record_date'],
            },
        ),
        migrations.AddConstraint(
            model_name='medicationdetail',
            constraint=models.UniqueConstraint(fields=('cycle', 'medication'), name='unique_cycle_medication'),
        ),
        migrations.AddConstraint(
            model_name='medicationcycle',
            constraint=models.UniqueConstraint(fields=('group', 'cycle_number'), name='unique_group_cycle'),
        ),
    ]
